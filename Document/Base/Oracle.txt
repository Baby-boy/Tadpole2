-- 修改Oracle表的字段顺序问题
第一步: 找到对应表的对象ID
SELECT OBJECT_ID FROM ALL_OBJECTS WHERE OBJECT_NAME='T_SIGN_GROUP';
第二步: 查询此表的字段对应的顺序
SELECT OBJ#,COL#,NAME FROM SYS.COL$ WHERE OBJ#=82389;　
第三步: 以超级用户的权限登录修改对应表的字段排序
UPDATE SYS.COL$ SET COL# = 13 WHERE OBJ#=82389 AND NAME= 'LAST_MODIFIED_DATE'

-- 查询所有序列
SELECT * from USER_SEQUENCES;

-- 创建序列
CREATE SEQUENCE SEQ_TEST
INCREMENT BY 1 -- 每次加几个
START WITH 1 -- 从1开始计数
NOMAXVALUE -- 不设置最大值
NOCYCLE -- 一直累加，不循环
NOCACHE -- 不建缓冲区

-- 查询序列值
SELECT SEQ_TEST.NEXTVAL FROM DUAL;

-- 修改序列值
alter sequence S_T_COMPANY increment by -20

-- 删除序列
DROP SEQUENCE SEQ_SIGN_POINT

-- 创建触发器
CREATE OR REPLACE TRIGGER TG_SIGN_POINT BEFORE INSERT ON T_SIGN_POINT FOR each
ROW WHEN(new.ID IS NULL)
BEGIN
SELECT SEQ_SIGN_POINT.NEXTVAL INTO:new.ID FROM DUAL;
END;

-- 修改Oracle连接超时问题
方法一、在sqlnet.ora中设置参数
如需要设置客户端空闲10分钟即被中断，则在sqlnet.ora的末尾添加SQLNET.EXPIRE_TIME=10
注：sqlnet.ora文件的路径在$ORACLE_HOME/network/admin下。 
方法二、Oracle Profile中设置
生产库上执行如下操作：
SQL> col name format a15
SQL> col value format a10
查询resource limit是否开启：
SQL> SELECT name, value FROM gv$parameter WHERE name = 'resource_limit';
NAME            VALUE
--------------- ----------
resource_limit  FALSE
如果没有，则开启这个参数：
SQL> ALTER SYSTEM SET RESOURCE_LIMIT=TRUE;
System altered.
SQL> SELECT name, value FROM gv$parameter WHERE name = 'resource_limit';
NAME            VALUE
--------------- ----------
resource_limit  TRUE
创建空闲10分钟中止空闲例程的Profile：
SQL> CREATE PROFILE app_user LIMIT IDLE_TIME  10;
Profile created.
设置用户的Profile：
SQL>alter user mzh profile app_user;
也可以修改已存在的Profile中的IDLE_TIME：
SQL> ALTER PROFILE DEFAULT LIMIT IDLE_TIME  10;

-- Oracle分页
SELECT 
	TT.* 
FROM(
	SELECT 
		R.*, ROWNUM RN
	FROM (
		-- 主体数据
	) R
	where 
	ROWNUM <=1
) TT 
WHERE TT.RN >=1

-- Oracle时间算法
SELECT 
	TS.DAY,TS.EMPLOYEE_CODE,TS.START_TIME,START_TIME + interval '1' day END_TIME,
	TS.SCHEDULE_START_TIME,TS.SCHEDULE_END_TIME
FROM(
	SELECT 
		TS.DAY,TS.EMPLOYEE_CODE,TO_DATE(SCHEDULE_START_TIME, 'yyyy-MM-dd HH24:mi:ss') - interval '4' hour START_TIME,
		TS.SCHEDULE_START_TIME,TS.SCHEDULE_END_TIME
	FROM(
		SELECT 
			TS.DAY,TS.EMPLOYEE_CODE,TS.YEAR||'-'||TS.MONTH||'-'||TS.DAY||' '||TWW.START_TIME||':00' SCHEDULE_START_TIME,
			TS.YEAR||'-'||TS.MONTH||'-'||TS.DAY||' '||TWW.END_TIME||':00' SCHEDULE_END_TIME
		FROM T_SCHEDULE TS 
		INNER JOIN T_WORK_WAY TWW ON TWW.ID = TS.WORK_WAY_ID 
		WHERE TS.DELETED = 0 AND TS.EMPLOYEE_CODE = 30001106
	) TS
)TS

-- Oracle表死锁问题解决
(system查询死锁表)
SELECT 
	s.sid,s.serial#
FROM v$locked_object lo,dba_objects ao ,v$SESSION s
WHERE ao.object_id = lo.object_id AND lo.session_id = s.sid
(杀掉死锁session)
ALTER system kill session 'sid,serial#';

-- Oracle由于监听日志过大,导致假死状态(删除以下命令该日志即可)
Oracle\diag\tnslsnr\DESKTOP-FST6VBK\listener\trace\listener.log

-- 修改密码永不过期
1. 查看用户的proifle是哪个，一般是default：
sql>SELECT username,PROFILE FROM dba_users;
2. 查看指定概要文件（如default）的密码有效期设置：
sql>SELECT * FROM dba_profiles s WHERE s.profile='DEFAULT' AND resource_name='PASSWORD_LIFE_TIME';
3. 将密码有效期由默认的180天修改成“无限制”：
ALTER PROFILE DEFAULT LIMIT PASSWORD_LIFE_TIME UNLIMITED;
修改之后不需要重启动数据库，会立即生效。
4. 修改后，还没有被提示ORA-28002警告的帐户不会再碰到同样的提示；
已经被提示的帐户必须再改一次密码，举例如下：
  $sqlplus / as sysdba
  sql> alter user smsc identified by <原来的密码> ----不用换新密码

-- 常用命令
sqlplus				: 运行SQLPLUS工具
sqlplus /nolog		: 直接进入SQLPLUS命令提示符
sqlplus / as sysdba	: 以os身份连接
connect / as sysdba	: 以os身份连接
sqlplus 用户/密码	: 普通用户登录
connect 用户/密码	: 普通用户登录
conn 用户/密码		: 切换用户
connect 用户/密码	: 切换用户
lsnrctl				: 进入监听状态
	stop			: 停止监听
	start			: 启动监听器
	status			: 监听状态
