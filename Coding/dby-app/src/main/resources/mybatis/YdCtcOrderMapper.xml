<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.yd.dby.app.mapper.YdCtcOrderMapper" >
  <resultMap id="BaseResultMap" type="com.yd.dby.app.entity.YdCtcOrder" >
    <id column="ctc_order_id" property="ctcOrderId" jdbcType="INTEGER" />
    <result column="ctc_order_sn" property="ctcOrderSn" jdbcType="BIGINT" />
    <result column="pay_sn" property="paySn" jdbcType="VARCHAR" />
    <result column="user_id" property="userId" jdbcType="INTEGER" />
    <result column="user_name" property="userName" jdbcType="VARCHAR" />
    <result column="buyer_id" property="buyerId" jdbcType="INTEGER" />
    <result column="buyer_name" property="buyerName" jdbcType="VARCHAR" />
    <result column="payment_code" property="paymentCode" jdbcType="VARCHAR" />
    <result column="payment_time" property="paymentTime" jdbcType="VARCHAR" />
    <result column="finnshed_time" property="finnshedTime" jdbcType="VARCHAR" />
    <result column="state_service" property="stateService" jdbcType="TINYINT" />
    <result column="state" property="state" jdbcType="TINYINT" />
    <result column="delete_state" property="deleteState" jdbcType="TINYINT" />
    <result column="ctc_id" property="ctcId" jdbcType="INTEGER" />
    <result column="ctc_cover" property="ctcCover" jdbcType="VARCHAR" />
    <result column="goods_name" property="goodsName" jdbcType="VARCHAR" />
    <result column="goods_price" property="goodsPrice" jdbcType="DECIMAL" />
    <result column="total_price" property="totalPrice" jdbcType="DECIMAL" />
    <result column="refund_price" property="refundPrice" jdbcType="DECIMAL" />
    <result column="transport_price" property="transportPrice" jdbcType="DECIMAL" />
    <result column="created_at" property="createdAt" jdbcType="VARCHAR" />
    <result column="cancel_reason" property="cancelReason" jdbcType="VARCHAR" />
    <result column="receipt_name" property="receiptName" jdbcType="VARCHAR" />
    <result column="receipt_mobile" property="receiptMobile" jdbcType="VARCHAR" />
    <result column="receipt_address" property="receiptAddress" jdbcType="VARCHAR" />
    <result column="shipping_address" property="shippingAddress" jdbcType="VARCHAR" />
    <result column="shipping_id" property="shippingId" jdbcType="INTEGER" />
    <result column="shipping_express" property="shippingExpress" jdbcType="VARCHAR" />
    <result column="shipping_code" property="shippingCode" jdbcType="VARCHAR" />
    <result column="shipping_time" property="shippingTime" jdbcType="VARCHAR" />
    <result column="evaluation_time" property="evaluationTime" jdbcType="VARCHAR" />
  </resultMap>
  <resultMap id="ResultMapWithBLOBs" type="com.yd.dby.app.entity.YdCtcOrderWithBLOBs" extends="BaseResultMap" >
    <result column="order_message" property="orderMessage" jdbcType="LONGVARCHAR" />
    <result column="deliver_explain" property="deliverExplain" jdbcType="LONGVARCHAR" />
  </resultMap>
  <sql id="Base_Column_List" >
    ctc_order_id, ctc_order_sn, pay_sn, user_id, user_name, buyer_id, buyer_name, payment_code, 
    payment_time, finnshed_time, state_service, state, delete_state, ctc_id, ctc_cover, 
    goods_name, goods_price, total_price, refund_price, transport_price, created_at, 
    cancel_reason, receipt_name, receipt_mobile, receipt_address, shipping_address, shipping_id, 
    shipping_express, shipping_code, shipping_time, evaluation_time
  </sql>
  <sql id="Blob_Column_List" >
    order_message, deliver_explain
  </sql>
  <select id="selectByPrimaryKey" resultMap="ResultMapWithBLOBs" parameterType="java.lang.Integer" >
    select 
    <include refid="Base_Column_List" />
    ,
    <include refid="Blob_Column_List" />
    from yd_ctc_order
    where ctc_order_id = #{ctcOrderId,jdbcType=INTEGER}
  </select>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.Integer" >
    delete from yd_ctc_order
    where ctc_order_id = #{ctcOrderId,jdbcType=INTEGER}
  </delete>
  <insert id="insert" parameterType="com.yd.dby.app.entity.YdCtcOrderWithBLOBs" >
    insert into yd_ctc_order (ctc_order_id, ctc_order_sn, pay_sn, 
      user_id, user_name, buyer_id, 
      buyer_name, payment_code, payment_time, 
      finnshed_time, state_service, state, 
      delete_state, ctc_id, ctc_cover, 
      goods_name, goods_price, total_price, 
      refund_price, transport_price, created_at, 
      cancel_reason, receipt_name, receipt_mobile, 
      receipt_address, shipping_address, shipping_id, 
      shipping_express, shipping_code, shipping_time, 
      evaluation_time, order_message, deliver_explain
      )
    values (#{ctcOrderId,jdbcType=INTEGER}, #{ctcOrderSn,jdbcType=BIGINT}, #{paySn,jdbcType=VARCHAR}, 
      #{userId,jdbcType=INTEGER}, #{userName,jdbcType=VARCHAR}, #{buyerId,jdbcType=INTEGER}, 
      #{buyerName,jdbcType=VARCHAR}, #{paymentCode,jdbcType=VARCHAR}, #{paymentTime,jdbcType=VARCHAR}, 
      #{finnshedTime,jdbcType=VARCHAR}, #{stateService,jdbcType=TINYINT}, #{state,jdbcType=TINYINT}, 
      #{deleteState,jdbcType=TINYINT}, #{ctcId,jdbcType=INTEGER}, #{ctcCover,jdbcType=VARCHAR}, 
      #{goodsName,jdbcType=VARCHAR}, #{goodsPrice,jdbcType=DECIMAL}, #{totalPrice,jdbcType=DECIMAL}, 
      #{refundPrice,jdbcType=DECIMAL}, #{transportPrice,jdbcType=DECIMAL}, #{createdAt,jdbcType=VARCHAR}, 
      #{cancelReason,jdbcType=VARCHAR}, #{receiptName,jdbcType=VARCHAR}, #{receiptMobile,jdbcType=VARCHAR}, 
      #{receiptAddress,jdbcType=VARCHAR}, #{shippingAddress,jdbcType=VARCHAR}, #{shippingId,jdbcType=INTEGER}, 
      #{shippingExpress,jdbcType=VARCHAR}, #{shippingCode,jdbcType=VARCHAR}, #{shippingTime,jdbcType=VARCHAR}, 
      #{evaluationTime,jdbcType=VARCHAR}, #{orderMessage,jdbcType=LONGVARCHAR}, #{deliverExplain,jdbcType=LONGVARCHAR}
      )
  </insert>
  <insert id="insertSelective" parameterType="com.yd.dby.app.entity.YdCtcOrderWithBLOBs" >
    insert into yd_ctc_order
    <trim prefix="(" suffix=")" suffixOverrides="," >
      <if test="ctcOrderId != null" >
        ctc_order_id,
      </if>
      <if test="ctcOrderSn != null" >
        ctc_order_sn,
      </if>
      <if test="paySn != null" >
        pay_sn,
      </if>
      <if test="userId != null" >
        user_id,
      </if>
      <if test="userName != null" >
        user_name,
      </if>
      <if test="buyerId != null" >
        buyer_id,
      </if>
      <if test="buyerName != null" >
        buyer_name,
      </if>
      <if test="paymentCode != null" >
        payment_code,
      </if>
      <if test="paymentTime != null" >
        payment_time,
      </if>
      <if test="finnshedTime != null" >
        finnshed_time,
      </if>
      <if test="stateService != null" >
        state_service,
      </if>
      <if test="state != null" >
        state,
      </if>
      <if test="deleteState != null" >
        delete_state,
      </if>
      <if test="ctcId != null" >
        ctc_id,
      </if>
      <if test="ctcCover != null" >
        ctc_cover,
      </if>
      <if test="goodsName != null" >
        goods_name,
      </if>
      <if test="goodsPrice != null" >
        goods_price,
      </if>
      <if test="totalPrice != null" >
        total_price,
      </if>
      <if test="refundPrice != null" >
        refund_price,
      </if>
      <if test="transportPrice != null" >
        transport_price,
      </if>
      <if test="createdAt != null" >
        created_at,
      </if>
      <if test="cancelReason != null" >
        cancel_reason,
      </if>
      <if test="receiptName != null" >
        receipt_name,
      </if>
      <if test="receiptMobile != null" >
        receipt_mobile,
      </if>
      <if test="receiptAddress != null" >
        receipt_address,
      </if>
      <if test="shippingAddress != null" >
        shipping_address,
      </if>
      <if test="shippingId != null" >
        shipping_id,
      </if>
      <if test="shippingExpress != null" >
        shipping_express,
      </if>
      <if test="shippingCode != null" >
        shipping_code,
      </if>
      <if test="shippingTime != null" >
        shipping_time,
      </if>
      <if test="evaluationTime != null" >
        evaluation_time,
      </if>
      <if test="orderMessage != null" >
        order_message,
      </if>
      <if test="deliverExplain != null" >
        deliver_explain,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides="," >
      <if test="ctcOrderId != null" >
        #{ctcOrderId,jdbcType=INTEGER},
      </if>
      <if test="ctcOrderSn != null" >
        #{ctcOrderSn,jdbcType=BIGINT},
      </if>
      <if test="paySn != null" >
        #{paySn,jdbcType=VARCHAR},
      </if>
      <if test="userId != null" >
        #{userId,jdbcType=INTEGER},
      </if>
      <if test="userName != null" >
        #{userName,jdbcType=VARCHAR},
      </if>
      <if test="buyerId != null" >
        #{buyerId,jdbcType=INTEGER},
      </if>
      <if test="buyerName != null" >
        #{buyerName,jdbcType=VARCHAR},
      </if>
      <if test="paymentCode != null" >
        #{paymentCode,jdbcType=VARCHAR},
      </if>
      <if test="paymentTime != null" >
        #{paymentTime,jdbcType=VARCHAR},
      </if>
      <if test="finnshedTime != null" >
        #{finnshedTime,jdbcType=VARCHAR},
      </if>
      <if test="stateService != null" >
        #{stateService,jdbcType=TINYINT},
      </if>
      <if test="state != null" >
        #{state,jdbcType=TINYINT},
      </if>
      <if test="deleteState != null" >
        #{deleteState,jdbcType=TINYINT},
      </if>
      <if test="ctcId != null" >
        #{ctcId,jdbcType=INTEGER},
      </if>
      <if test="ctcCover != null" >
        #{ctcCover,jdbcType=VARCHAR},
      </if>
      <if test="goodsName != null" >
        #{goodsName,jdbcType=VARCHAR},
      </if>
      <if test="goodsPrice != null" >
        #{goodsPrice,jdbcType=DECIMAL},
      </if>
      <if test="totalPrice != null" >
        #{totalPrice,jdbcType=DECIMAL},
      </if>
      <if test="refundPrice != null" >
        #{refundPrice,jdbcType=DECIMAL},
      </if>
      <if test="transportPrice != null" >
        #{transportPrice,jdbcType=DECIMAL},
      </if>
      <if test="createdAt != null" >
        #{createdAt,jdbcType=VARCHAR},
      </if>
      <if test="cancelReason != null" >
        #{cancelReason,jdbcType=VARCHAR},
      </if>
      <if test="receiptName != null" >
        #{receiptName,jdbcType=VARCHAR},
      </if>
      <if test="receiptMobile != null" >
        #{receiptMobile,jdbcType=VARCHAR},
      </if>
      <if test="receiptAddress != null" >
        #{receiptAddress,jdbcType=VARCHAR},
      </if>
      <if test="shippingAddress != null" >
        #{shippingAddress,jdbcType=VARCHAR},
      </if>
      <if test="shippingId != null" >
        #{shippingId,jdbcType=INTEGER},
      </if>
      <if test="shippingExpress != null" >
        #{shippingExpress,jdbcType=VARCHAR},
      </if>
      <if test="shippingCode != null" >
        #{shippingCode,jdbcType=VARCHAR},
      </if>
      <if test="shippingTime != null" >
        #{shippingTime,jdbcType=VARCHAR},
      </if>
      <if test="evaluationTime != null" >
        #{evaluationTime,jdbcType=VARCHAR},
      </if>
      <if test="orderMessage != null" >
        #{orderMessage,jdbcType=LONGVARCHAR},
      </if>
      <if test="deliverExplain != null" >
        #{deliverExplain,jdbcType=LONGVARCHAR},
      </if>
    </trim>
  </insert>
  <update id="updateByPrimaryKeySelective" parameterType="com.yd.dby.app.entity.YdCtcOrderWithBLOBs" >
    update yd_ctc_order
    <set >
      <if test="ctcOrderSn != null" >
        ctc_order_sn = #{ctcOrderSn,jdbcType=BIGINT},
      </if>
      <if test="paySn != null" >
        pay_sn = #{paySn,jdbcType=VARCHAR},
      </if>
      <if test="userId != null" >
        user_id = #{userId,jdbcType=INTEGER},
      </if>
      <if test="userName != null" >
        user_name = #{userName,jdbcType=VARCHAR},
      </if>
      <if test="buyerId != null" >
        buyer_id = #{buyerId,jdbcType=INTEGER},
      </if>
      <if test="buyerName != null" >
        buyer_name = #{buyerName,jdbcType=VARCHAR},
      </if>
      <if test="paymentCode != null" >
        payment_code = #{paymentCode,jdbcType=VARCHAR},
      </if>
      <if test="paymentTime != null" >
        payment_time = #{paymentTime,jdbcType=VARCHAR},
      </if>
      <if test="finnshedTime != null" >
        finnshed_time = #{finnshedTime,jdbcType=VARCHAR},
      </if>
      <if test="stateService != null" >
        state_service = #{stateService,jdbcType=TINYINT},
      </if>
      <if test="state != null" >
        state = #{state,jdbcType=TINYINT},
      </if>
      <if test="deleteState != null" >
        delete_state = #{deleteState,jdbcType=TINYINT},
      </if>
      <if test="ctcId != null" >
        ctc_id = #{ctcId,jdbcType=INTEGER},
      </if>
      <if test="ctcCover != null" >
        ctc_cover = #{ctcCover,jdbcType=VARCHAR},
      </if>
      <if test="goodsName != null" >
        goods_name = #{goodsName,jdbcType=VARCHAR},
      </if>
      <if test="goodsPrice != null" >
        goods_price = #{goodsPrice,jdbcType=DECIMAL},
      </if>
      <if test="totalPrice != null" >
        total_price = #{totalPrice,jdbcType=DECIMAL},
      </if>
      <if test="refundPrice != null" >
        refund_price = #{refundPrice,jdbcType=DECIMAL},
      </if>
      <if test="transportPrice != null" >
        transport_price = #{transportPrice,jdbcType=DECIMAL},
      </if>
      <if test="createdAt != null" >
        created_at = #{createdAt,jdbcType=VARCHAR},
      </if>
      <if test="cancelReason != null" >
        cancel_reason = #{cancelReason,jdbcType=VARCHAR},
      </if>
      <if test="receiptName != null" >
        receipt_name = #{receiptName,jdbcType=VARCHAR},
      </if>
      <if test="receiptMobile != null" >
        receipt_mobile = #{receiptMobile,jdbcType=VARCHAR},
      </if>
      <if test="receiptAddress != null" >
        receipt_address = #{receiptAddress,jdbcType=VARCHAR},
      </if>
      <if test="shippingAddress != null" >
        shipping_address = #{shippingAddress,jdbcType=VARCHAR},
      </if>
      <if test="shippingId != null" >
        shipping_id = #{shippingId,jdbcType=INTEGER},
      </if>
      <if test="shippingExpress != null" >
        shipping_express = #{shippingExpress,jdbcType=VARCHAR},
      </if>
      <if test="shippingCode != null" >
        shipping_code = #{shippingCode,jdbcType=VARCHAR},
      </if>
      <if test="shippingTime != null" >
        shipping_time = #{shippingTime,jdbcType=VARCHAR},
      </if>
      <if test="evaluationTime != null" >
        evaluation_time = #{evaluationTime,jdbcType=VARCHAR},
      </if>
      <if test="orderMessage != null" >
        order_message = #{orderMessage,jdbcType=LONGVARCHAR},
      </if>
      <if test="deliverExplain != null" >
        deliver_explain = #{deliverExplain,jdbcType=LONGVARCHAR},
      </if>
    </set>
    where ctc_order_id = #{ctcOrderId,jdbcType=INTEGER}
  </update>
  <update id="updateByPrimaryKeyWithBLOBs" parameterType="com.yd.dby.app.entity.YdCtcOrderWithBLOBs" >
    update yd_ctc_order
    set ctc_order_sn = #{ctcOrderSn,jdbcType=BIGINT},
      pay_sn = #{paySn,jdbcType=VARCHAR},
      user_id = #{userId,jdbcType=INTEGER},
      user_name = #{userName,jdbcType=VARCHAR},
      buyer_id = #{buyerId,jdbcType=INTEGER},
      buyer_name = #{buyerName,jdbcType=VARCHAR},
      payment_code = #{paymentCode,jdbcType=VARCHAR},
      payment_time = #{paymentTime,jdbcType=VARCHAR},
      finnshed_time = #{finnshedTime,jdbcType=VARCHAR},
      state_service = #{stateService,jdbcType=TINYINT},
      state = #{state,jdbcType=TINYINT},
      delete_state = #{deleteState,jdbcType=TINYINT},
      ctc_id = #{ctcId,jdbcType=INTEGER},
      ctc_cover = #{ctcCover,jdbcType=VARCHAR},
      goods_name = #{goodsName,jdbcType=VARCHAR},
      goods_price = #{goodsPrice,jdbcType=DECIMAL},
      total_price = #{totalPrice,jdbcType=DECIMAL},
      refund_price = #{refundPrice,jdbcType=DECIMAL},
      transport_price = #{transportPrice,jdbcType=DECIMAL},
      created_at = #{createdAt,jdbcType=VARCHAR},
      cancel_reason = #{cancelReason,jdbcType=VARCHAR},
      receipt_name = #{receiptName,jdbcType=VARCHAR},
      receipt_mobile = #{receiptMobile,jdbcType=VARCHAR},
      receipt_address = #{receiptAddress,jdbcType=VARCHAR},
      shipping_address = #{shippingAddress,jdbcType=VARCHAR},
      shipping_id = #{shippingId,jdbcType=INTEGER},
      shipping_express = #{shippingExpress,jdbcType=VARCHAR},
      shipping_code = #{shippingCode,jdbcType=VARCHAR},
      shipping_time = #{shippingTime,jdbcType=VARCHAR},
      evaluation_time = #{evaluationTime,jdbcType=VARCHAR},
      order_message = #{orderMessage,jdbcType=LONGVARCHAR},
      deliver_explain = #{deliverExplain,jdbcType=LONGVARCHAR}
    where ctc_order_id = #{ctcOrderId,jdbcType=INTEGER}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.yd.dby.app.entity.YdCtcOrder" >
    update yd_ctc_order
    set ctc_order_sn = #{ctcOrderSn,jdbcType=BIGINT},
      pay_sn = #{paySn,jdbcType=VARCHAR},
      user_id = #{userId,jdbcType=INTEGER},
      user_name = #{userName,jdbcType=VARCHAR},
      buyer_id = #{buyerId,jdbcType=INTEGER},
      buyer_name = #{buyerName,jdbcType=VARCHAR},
      payment_code = #{paymentCode,jdbcType=VARCHAR},
      payment_time = #{paymentTime,jdbcType=VARCHAR},
      finnshed_time = #{finnshedTime,jdbcType=VARCHAR},
      state_service = #{stateService,jdbcType=TINYINT},
      state = #{state,jdbcType=TINYINT},
      delete_state = #{deleteState,jdbcType=TINYINT},
      ctc_id = #{ctcId,jdbcType=INTEGER},
      ctc_cover = #{ctcCover,jdbcType=VARCHAR},
      goods_name = #{goodsName,jdbcType=VARCHAR},
      goods_price = #{goodsPrice,jdbcType=DECIMAL},
      total_price = #{totalPrice,jdbcType=DECIMAL},
      refund_price = #{refundPrice,jdbcType=DECIMAL},
      transport_price = #{transportPrice,jdbcType=DECIMAL},
      created_at = #{createdAt,jdbcType=VARCHAR},
      cancel_reason = #{cancelReason,jdbcType=VARCHAR},
      receipt_name = #{receiptName,jdbcType=VARCHAR},
      receipt_mobile = #{receiptMobile,jdbcType=VARCHAR},
      receipt_address = #{receiptAddress,jdbcType=VARCHAR},
      shipping_address = #{shippingAddress,jdbcType=VARCHAR},
      shipping_id = #{shippingId,jdbcType=INTEGER},
      shipping_express = #{shippingExpress,jdbcType=VARCHAR},
      shipping_code = #{shippingCode,jdbcType=VARCHAR},
      shipping_time = #{shippingTime,jdbcType=VARCHAR},
      evaluation_time = #{evaluationTime,jdbcType=VARCHAR}
    where ctc_order_id = #{ctcOrderId,jdbcType=INTEGER}
  </update>
  
  
  <resultMap type="com.yd.dby.app.entity.vo.CtcOrderDetailsVo" id="CtcOrderDetailsVoResultMap">
  	<id column="ctc_order_id" property="ctcOrderId" jdbcType="INTEGER" />
  	<result column="ctc_order_sn" property="ctcOrderSn" jdbcType="BIGINT" />
  	<result column="ctc_cover" property="ctcCover" jdbcType="VARCHAR" />
  	<result column="goods_name" property="goodsName" jdbcType="VARCHAR" />
    <result column="goods_price" property="goodsPrice" jdbcType="DECIMAL" />
    <result column="total_price" property="totalPrice" jdbcType="DECIMAL" />
    <result column="state" property="state" jdbcType="TINYINT" />
    <result column="shipping_time" property="shippingTime" jdbcType="VARCHAR" />
  </resultMap>
  
    <!-- 订单列表的查询 -->
  <sql id="selectOrderPageList_Where">
  	<where>
  		yco.buyer_id=#{para.userId,jdbcType=INTEGER}
  		<if test="para.states !=null">
  			and yco.state in 
  			<foreach collection="para.states" item="orderState" open="(" close=")" separator=",">
				#{orderState,jdbcType=INTEGER}
			</foreach>
  		</if>
  	</where>
  </sql>
  <select id="selectOrderPageCount" resultType="java.lang.Integer" parameterType="com.yd.dby.app.entity.para.CtcOrderPara">
  	select 
  	count(DISTINCT yco.ctc_order_id)
	from yd_ctc_order yco
	<include refid="selectOrderPageList_Where"/>
  </select>
  <select id="selectOrderPageList" resultMap="BaseResultMap" parameterType="com.yd.dby.app.entity.para.CtcOrderPara">
	select 
	yco.user_id,yco.user_name,yco.state,yco.ctc_cover,
	yco.ctc_id,yco.ctc_cover,yco.goods_name,yco.goods_price,yco.ctc_order_id
	from yd_ctc_order yco
	left join yd_user yu on yu.user_id=yco.user_id
	<include refid="selectOrderPageList_Where"/>
	order by yco.ctc_order_id desc
    limit #{para.startIndex, jdbcType=INTEGER},#{para.onePageCount, jdbcType=INTEGER} 
  </select>
  
  <select id="selectOrderDetails" parameterType="java.lang.Integer" resultMap="CtcOrderDetailsVoResultMap">
  	select 
		yco.ctc_order_id,yco.ctc_order_sn,yco.ctc_cover,yco.goods_name,yco.goods_price,yco.total_price,yco.state,yco.shipping_time 
	from yd_ctc_order yco
	where yco.ctc_order_id=230
  </select>
</mapper>